{"ast":null,"code":"var _jsxFileName = \"/home/lenix/PycharmProjects/GBC/frontend/src/components/ControlCenter/StyleMenu/Forms/InputForms/ColorForm.js\";\nimport React, { Component } from 'react';\nimport { ChromePicker } from \"react-color\";\nimport { setComponentState } from \"../../../../../store/libraryState/actions\";\nimport { connect } from \"react-redux\"; // форма выбора цвета\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass ColorForm extends Component {\n  constructor(props) {\n    super(props); // isOpen: открыта ли цветовая палитра?\n    // color: выбранный на палитре цвет\n\n    this.onClickHandler = () => {\n      this.setState(currentState => ({\n        isOpen: !currentState.isOpen\n      }));\n    };\n\n    this.onClickOutsideHandler = event => {\n      if (this.state.isOpen && !this.toggleContainer.current.contains(event.target)) {\n        this.setState({\n          isOpen: false\n        });\n      }\n    };\n\n    this.handleChange = color => {\n      const {\n        setComponentState,\n        componentName,\n        styleType\n      } = this.props;\n      setComponentState(componentName, styleType, color.hex);\n      this.setState({\n        color: color.hex\n      });\n    };\n\n    this.isOpen = () => {\n      return this.state.isOpen;\n    };\n\n    this.state = {\n      isOpen: false,\n      color: '#ec9360'\n    }; // создание рефа, который прикрепится к палитре и к самой форме\n\n    this.toggleContainer = /*#__PURE__*/React.createRef();\n  } // метод, вызывающийся сразу после рендера компонента\n  // обработчик событий дает возможность скрыть цветовую палитру при нажатии за её пределы\n\n\n  componentDidMount() {\n    window.addEventListener('click', this.onClickOutsideHandler);\n  } // удаляем обработчик, объявленный выше\n\n\n  componentWillUnmount() {\n    window.removeEventListener('click', this.onClickOutsideHandler);\n  } // метод жизненного цикла, позволяющий сбросить значение формы,\n  // а также синхронизировать состояние формы со стилем компонента\n\n\n  static getDerivedStateFromProps(props, state) {\n    const {\n      componentsState,\n      componentName,\n      styleType\n    } = props;\n    const componentStyle = componentsState[componentName]; // если стили были сброшены вручную (resetStyles), то форма примет значения по умолчанию,\n\n    if (componentStyle[styleType] === '' && state.color !== '#ec9360' && !state.isOpen) {\n      return {\n        isOpen: false,\n        color: '#ec9360'\n      }; // синхронизация значения формы и стиля компонента\n    } else if (componentStyle[styleType] !== state.color && componentStyle[styleType] !== '') {\n      return {\n        isOpen: state.isOpen,\n        color: componentStyle[styleType]\n      };\n    } // в ином случае оставить без изменений\n\n\n    return null;\n  } // при нажатии на форму открывает или закрывает цветовую палитру\n\n\n  render() {\n    const {\n      label\n    } = this.props; // отображать или скрыть цветовую палитру\n\n    const colorPicker = this.isOpen() && /*#__PURE__*/_jsxDEV(ChromePicker, {\n      color: this.state.color,\n      onChange: this.handleChange,\n      disableAlpha: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 46\n    }, this);\n\n    return /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"form\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"form__label\",\n        children: label\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form__wrapper\",\n        ref: this.toggleContainer,\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"form__color-btn\",\n          type: \"button\",\n          onClick: this.onClickHandler,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              background: this.state.color\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 24\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: this.state.color\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 24\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 20\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form__color-picker\",\n          children: colorPicker\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }, this);\n  } // обрабатывает изменение цвета и с помощью колбэка передает эти изменения\n\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    componentName: state.currentComponent.componentName,\n    componentsState: state.libraryState,\n    isUserComponent: state.currentComponent.isUserComponent\n  };\n};\n\nconst mapDispatchToProps = {\n  setComponentState\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(ColorForm);","map":{"version":3,"sources":["/home/lenix/PycharmProjects/GBC/frontend/src/components/ControlCenter/StyleMenu/Forms/InputForms/ColorForm.js"],"names":["React","Component","ChromePicker","setComponentState","connect","ColorForm","constructor","props","onClickHandler","setState","currentState","isOpen","onClickOutsideHandler","event","state","toggleContainer","current","contains","target","handleChange","color","componentName","styleType","hex","createRef","componentDidMount","window","addEventListener","componentWillUnmount","removeEventListener","getDerivedStateFromProps","componentsState","componentStyle","render","label","colorPicker","background","mapStateToProps","currentComponent","libraryState","isUserComponent","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {ChromePicker} from \"react-color\";\nimport {setComponentState} from \"../../../../../store/libraryState/actions\";\nimport {connect} from \"react-redux\";\n\n// форма выбора цвета\nclass ColorForm extends Component {\n    constructor(props) {\n        super(props);\n\n        // isOpen: открыта ли цветовая палитра?\n        // color: выбранный на палитре цвет\n        this.state = {\n            isOpen: false,\n            color: '#ec9360',\n        };\n\n        // создание рефа, который прикрепится к палитре и к самой форме\n        this.toggleContainer = React.createRef();\n    }\n\n    // метод, вызывающийся сразу после рендера компонента\n    // обработчик событий дает возможность скрыть цветовую палитру при нажатии за её пределы\n    componentDidMount() {\n        window.addEventListener('click', this.onClickOutsideHandler);\n    }\n\n    // удаляем обработчик, объявленный выше\n    componentWillUnmount() {\n        window.removeEventListener('click', this.onClickOutsideHandler);\n    }\n    \n    // метод жизненного цикла, позволяющий сбросить значение формы,\n    // а также синхронизировать состояние формы со стилем компонента\n    static getDerivedStateFromProps(props, state) {\n        const {componentsState, componentName, styleType} = props;\n        const componentStyle = componentsState[componentName];\n\n        // если стили были сброшены вручную (resetStyles), то форма примет значения по умолчанию,\n        if (componentStyle[styleType] === '' &&\n            state.color !== '#ec9360' &&\n            !state.isOpen\n           ) {\n            return {\n                isOpen: false,\n                color: '#ec9360',\n            }\n        // синхронизация значения формы и стиля компонента\n        } else if (componentStyle[styleType] !== state.color && componentStyle[styleType] !== '') {\n            return {\n                isOpen: state.isOpen,\n                color: componentStyle[styleType]\n            }\n        }\n\n        // в ином случае оставить без изменений\n        return null;\n    }\n\n    // при нажатии на форму открывает или закрывает цветовую палитру\n    onClickHandler = () => {\n        this.setState(currentState => ({\n            isOpen: !currentState.isOpen\n        }));\n    }\n\n    // если нажатие произведено вне цветовой палитры, то она будет закрыта\n    onClickOutsideHandler = (event) => {\n        if (this.state.isOpen && !this.toggleContainer.current.contains(event.target)) {\n            this.setState({ isOpen: false });\n        }\n    }\n\n    render() {\n        const {label} = this.props;\n        // отображать или скрыть цветовую палитру\n        const colorPicker = this.isOpen() && <ChromePicker color={ this.state.color }\n                                                           onChange={ this.handleChange }\n                                                           disableAlpha={true}/>;\n\n        return (\n            <form className=\"form\">\n                <label className=\"form__label\">{label}</label>\n                <div className=\"form__wrapper\" ref={this.toggleContainer}>\n                   <button className=\"form__color-btn\"\n                          type=\"button\"\n                          onClick={this.onClickHandler}>\n                       <div style={{background: this.state.color}}/>\n                       <p>{this.state.color}</p>\n                    </button>\n\n                    <div className=\"form__color-picker\">\n                        {colorPicker}\n                    </div>\n                </div>\n            </form>\n        );\n    }\n\n    // обрабатывает изменение цвета и с помощью колбэка передает эти изменения\n    handleChange = (color) => {\n        const {setComponentState, componentName, styleType} = this.props;\n        setComponentState(componentName, styleType, color.hex);\n\n        this.setState({\n            color: color.hex\n        })\n    }\n\n    isOpen = () => {\n        return this.state.isOpen;\n    }\n}\n\nconst mapStateToProps = (state) => {\n    return {\n        componentName: state.currentComponent.componentName,\n        componentsState: state.libraryState,\n        isUserComponent: state.currentComponent.isUserComponent,\n    }\n}\n\nconst mapDispatchToProps = {\n    setComponentState\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ColorForm);\n"]},"metadata":{},"sourceType":"module"}